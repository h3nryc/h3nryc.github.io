<!DOCTYPE html>
<html>
<head>
	<title>Qu - Playlist</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<script   src="https://code.jquery.com/jquery-3.1.0.min.js"   integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="   crossorigin="anonymous"></script>  
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-81625151-1', 'auto');
	  ga('send', 'pageview');

	</script>
	<style type="text/css">
	::-webkit-input-placeholder {color: #333;font-weight: 450;}:-moz-placeholder {color: #333;  }::-moz-placeholder {color: #333;}:-ms-input-placeholder {color: #333;}
		input:focus,
		select:focus,
		textarea:focus,
		button:focus {
    		outline: none;
		}
		#main-input{
			border: 0;
			background-color: #eee;
			height: 80px;
			font-size: 40pt;
			width: 100%;
		}
		#songs{
			width: 50%;
    		margin: 0 auto; 
		}
		#progressBar {
		width: 960px;
		height: 6px;
		background-color: #444444;
		display: none;
		margin-top: 1px;
		}

		#progressBar div {
		height: 100%;
		width: 0;
		background-color: #ffffff;
		}
	</style>
</head>
<body>
	<div id="main" class="jumbotron">
		<input id="main-input" type="text" placeholder="Qu - Click here to paste a youtube url"name="link">
	</div>
	<div class="fill">
		<br>
		<br>
		<h1 class="text-center" >No Videos Selected</h1>
		<h4 class="text-center" >This tool lets you easily create a queue of music</h4>
		<h4 class="text-center" >Try https://www.youtube.com/watch?v=KMU0tzLwhbE</h4>
		<h4 class="text-center" >Click the circle play button after selecting some songs!</h4>
	</div>

	<div class="span6 offset3" id="songs">
		<ul class="list-group">

		</ul>
	</div>
	<div id="vid"style="display: none;">
		    <div id="player"></div>
	</div>
	
	<div style="background-color: #eee; margin-top; 6px;" class="navbar navbar-fixed-bottom">
		 <p class="text-center">      <span onclick="start();" style="font-size: 30pt;" class="glyphicon glyphicon-play-circle"></span>      <span onclick="stopVideo();" style="font-size: 30pt;" class="glyphicon glyphicon-pause"></span>      <span  onclick="playVideo();" style="font-size: 30pt;" class="glyphicon glyphicon-play"></span>      <span  onclick="nextVideo();" style="font-size: 30pt;" class="glyphicon glyphicon-step-forward"></span></p>
	</div>
<script>
//Load YT Api
      var tag = document.createElement('script');
      var vidList = [];
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

$(document).ready(function() {
   $("#main-input").keyup(function(e) {
    if (e.which == 13) {
    	var input = $('#main-input').val();
      main(input)
    }
	});
   $(document).keydown(function(e){
    if (e.keyCode == 39) { 
       nextVideo();
       return false;
    }
});
});
var player;
function main(input){
	$('#main-input').val('');
	$(".fill").empty()
	$('.list-group').append('<li class="list-group-item text-center">'+input+'</li>')
	input = input.substr(input.lastIndexOf('=') + 1);
    vidList.push(input);	
}
 //Gets Ready to make player
function passVid(input){
	console.log("passVid")
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          videoId: input,
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
}
	 	      

function getTitle(data) {
 var feed = data.feed;
 var entries = feed.entry || [];
  for (var i = 0; i < entries.length; i++) {
   var entry = entries[i];
   var title = entry.title.$t;
  }
 } 

// When ready makes Player
      function onPlayerReady(event) {
        event.target.playVideo();
      }
//Fires when video is done
function onPlayerStateChange(event) {
        if (event.data == 0) {
          nextVideo()
        }
      }
//Player Actions
 function stopVideo() {
        player.pauseVideo();
      }
      function playVideo(){
      	player.playVideo();
      }
function nextVideo() {
	player.stopVideo();
	$('#vid').empty();
	$('#vid').append('<div id="player"></div>');
	vidList.splice(0, 1);
	if (vidList[0] === undefined) {
		alert("You have reached the end of your cue")
		return;
	}else{
		passVid(vidList[0])
	}
}

function start(){
	passVid(vidList[0])
}

</script>
</body>
</html>